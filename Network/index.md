
### HTTP1 存在的问题


#### TCP 连接数限制

以 Chrome 来说，同一域名下同时最多发起 6 个 TCP 请求。一个页面往往有好几十个资源，为了解决这个问题，使用 `域名分片` 将资源放在不同的域名下。

不同域名发起请求，以一种比较巧妙的方式避开了请求数量的限制。

#### 队头堵塞

浏览器向服务器请求文件。假设请求A、B两个文件。如果两个文件差不多大，那发送顺序大概是这样的：

```typescript
AAABBB
```

如果A比B大的多，就会是这个样子：
```typescript
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAABB
```

A 需要很久的时间才发送完，B的发送就一直被挡在A后面，这就是 `队头堵塞`。


解决方案是将文件分成很小的「块」，在网络链路上分块发送这些「块」。大概是这样：

```typescript
ABABAAAAAAAAAAAAAAAAAAAAAAAAAAA
```

这样队列中比较小的文件就能更快地到达。
